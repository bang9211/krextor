###################################################################################
# Main Configuration
###################################################################################

[UXCUTOR/COMMON]
MAX_MQ_SIZE	= 2048 #Worker Thread 메시지 큐 최대 크기 2048
USE_MQ = ON # IPC MsgQ Handler를 사용한다
USE_FD = ON # FD Handler를 사용한다
MAX_MESSAGE_SIZE = 20480 # IPC Message 최대 길이 20480
MAX_THREAD = 2 # 사용하는 Worker Thread 6개
MPOOL_MAX_FREE = 0 # Mega byte. MPool 유지 최대 메모리 제한 없음.
QUEUE_PRINT_LWM = 100 # Worker MQ에 100개 이상 메시지가 차면 MINOR 로그 출력
#LOG_FORMAT = 0x0400BE # 0x0400BE(default)
DEFAULT_LOG_FILE = log/ibcf/ibcf # 설정된 파일로 로깅
#LOG_FORMAT = 0x0000BE # 0x0400BE(default)
#DEFAULT_LOG_FILE = log/roif/roif.%Y%m%d

[UXCUTOR/LIBRARY]
libluajit-5.1.so
libudbc.so
libsctp.so
libuxtpsctp.so
libssl.so
libcrypto.so
libuxtptls.so
# for SIP protocol adapter
#libutxmsg.so
libusip.so
# for DIAMETER protocol adapter
libudia.so
libupa_dia.so
# for tarantool 
libtarantool.so
libusdp.so
libnghttp2.so 
libuhttp.so 

[UXCUTOR/ACTOR]
#actor kind; dll file; module_create_function; configuration_file(opt)
LUA; libuact_lua.so; uxc_actlua_module_create;
SQL; libuact_sql.so; uxc_actsql_module_create;

[UXCUTOR/PROTOCOL_ADAPTER]
# protocol_adapter_name; protocol adapter id; dll_file; padapter_create_function; configuration_file(opt)
PA_MMIF; 0; libupa_mmif.so; upa_mmif_create;
#PA_DBIF; 1; libupa_dbif.so; upa_dbif_create;
PA_SIP; 2; libupa_sip.so; upa_sippa_create;
PA_DIAMETER; 3; libupa_dia.so; upa_dia_create;
PA_HTTP; 4; libupa_http.so; upa_httppa_create;

[UXCUTOR/PLUGIN]
# plugin-dll-file; DLL STATIC or DYNAMIC; plugin_create_function(opt); configuration_file(opt)
liblua_uxlib.so; STATIC;
liblua_udbc.so; STATIC;
liblua_uxcutor.so; STATIC;
liblua_usip.so; STATIC;
liblua_upasip.so; STATIC;
liblua_udia.so; STATIC;
libuxcsl.so; STATIC; uxcsl_plugin_create;
libuims.so; STATIC; uims_plugin_create;
libibcf.so; STATIC; ibcf_plugin_create;
libuxcpt_dia.so; DYNAMIC; uxcpt_dia_create;
#liblua_uhttp.so; STATIC;
#liblua_upahttp.so; STATIC;
libuxcpt_http.so; DYNAMIC; uxcpt_http_create;


[UXCUTOR/SERVICE_SELECTOR]
# SvcSel-Name; SvcSel-Id; PA Name; App-Id; dll_file; Creator; configuraton_fil(opt)
MASIP; 1; PA_SIP; 0; libuxcss_sip.so; uxcss_masip_create;

[UXCUTOR/SERVICE]
HOST_ID = 1
MAX_SESSION_PER_THREAD = 200000
#SESSION_EXPIRE_TIME = 600000 # 0이면 동작 안함
#SESSION_CHECK_PERIOD = 0 # 0이면 동작 안함
#INDEX_BIN_SIZE = 16381
#UPDATE_SESSMETA = OFF
#HA_MODE = ACTIVE-ACTIVE  # ACTIVE-ACTIVE(0)/ACTIVE-STANDBY(1) 
#HA_GETTER = SYTEM_DEPEND # SYSTEM_DEPEND(0)/SYTEM_REVERSE(1)/ACTIVE_ONLY(2)/STANDBY_ONLY(3) 
BACKUP_DIR = $UASYS_HOME/data/svcmeta

[UXCUTOR/SERVICE/UXCRIPT]
# file or directory
$UASYS_HOME/service/ibcf/global.xcpt
$UASYS_HOME/service/ibcf
#$UASYS_HOME/service/ibcf/invite.xcpt
#$UASYS_HOME/service/ibcf/register.xcpt
#$UASYS_HOME/service/ibcf/subscribe.xcpt
#$UASYS_HOME/service/ibcf/request.xcpt

[UXCUTOR/LOG]
# log_domain_name; log_id; flags(STDOUT,UALOG); log info; log sink dll(opt)
#now fix....
rtpp_log; 1; UALOG; file($UASYS_HOME/log/ibcf/rtpplog, 0x1f, 0x04008E);

[UXCUTOR/STATISTICS]
#CONF_FILE = $UASYS_HOME/data/statistics.xml

[UXCUTOR/CDR]
#CONF_FILE = $UASYS_HOME/data/uxcutor.conf

[UXCUTOR/PLUGIN/UXCSL/SDM/GLOBAL]
rtpp_name = RTPENGINE

[UXCUTOR/PLUGIN/UXCSL/SDM/SERVICE/REGISTER]
# service variables

[UXCUTOR/PLUGIN/UXCSL/SDM/SERVICE/INVITE]
# service variables

[UXCUTOR/TRACE]
ALLKEY = 0101111111 
MAX_TRACE = 16
MAX_ALLKEY_TRACE = 0 
PART_MATCH = OFF
TYPE = FILE # 0: OAM, 1: FILE,  other nubmer : extenstion
HEADER_FORMAT = */%s/* # OAM trace header format
FILE_FORMAT = $UASYS_HOME/log/TRACE/%f/trace-%K.%Y%m%d # trace file format 

[UXCUTOR/ACTION]
# action_name; from; to; kind; function_name; file_name(opt); flags(opt) 
# flags : 0x01(PUSH_ALL_THREAD) 

# uxcutor default mmc command
dis-ibcf-status; 20100603000000; 20301231235959; SYS; uxc_sysmmc_display
chg-ibcf-conf; 20100603000000; 20301231235959; SYS; uxc_sysmmc_change
reload-ibcf-conf; 20100603000000; 20301231235959; SYS; uxc_sysmmc_reload
dis-ibcf-trc; 20100603000000; 20301231235959; SYS; uxc_sysmmc_dis_trc
dis-ibcf-ttrc; 20100603000000; 20301231235959; SYS; uxc_sysmmc_dis_total_trc
add-ibcf-trc;  20100603000000; 20301231235959; SYS; uxc_sysmmc_add_trc
del-ibcf-trc; 20100603000000; 20301231235959; SYS; uxc_sysmmc_del_trc

uims_plugin_handle_sip; 20100101000000; 20321231125959; DLL; uims_plugin_handle_sip; libuims.so
uxcpt_handle_http; 20100101000000; 21121231125959; DLL; uxcpt_handle_http; libuxcpt_http.so


###################################################################################
# Actors Configuration
###################################################################################

[UXCUTOR/SQL/DB_CONNECTOR]
# UDBC DB Connection Manager Driver Configuration : lib=libuact_sql, class=uxc_dbcmgr_t
# driver dll; driver configurations
#libudbc_alti.so; user=uocs; password=uocs; port=20400; host=192.168.1.40; conntype=1; CONNECTION_TIME=5;

[UXCUTOR/LUA/COMMON]
#FILE_EXTENSION=out # LUA script 확장자.  default=lua, out은 compiled lua script 확장자.
#MAX_SIMULTANEOUS_RELOAD=0 #동시에 reload 수행하는 worker의 최대 개수, default=0(제한 없음)

[UXCUTOR/LUA/SCRIPT]
# file or directory
$UASYS_HOME/lua/script/uims/common.lua

###################################################################################
# Protocol Adapters Configuration
###################################################################################

[UXCUTOR/PA_MMIF/COMMON]
# MMIF PA common configuration : lib=libupa_mmif, class=upa_mmif_t
# MTYPE = 2,5


[UXCUTOR/PA_HTTP/COMMON]
# HTTP protocol adapter common configuration : lib=libupa_http, class=upa_http_t
action_name = uxcpt_handle_http 
#recv_timeout = 3000
uhttp_conf = data/uhttp_conf.xml
#stack_stat_shm=


[UXCUTOR/PA_SIP/COMMON]
# SIP PA common configuration : lib=libupa_sip, class=upa_sippa_t
action_name = uims_plugin_handle_sip
contact = <sip:192.168.1.182:15064>
ltagkey = uimsi
usip_conf = data/ibcf-sip-conf.xml
#max_channel = 64 # max channel count 
#reconnect_time = 5 	# seconds
#sock_buf_size = 0
#recv_timeout = 3000  #msec
#thread_count = 0
#del_chnl_alive_time = 600 # deleted channel alive time (unit:sec)
#is_run_stack = false # run stack, default TRUE
#stack_stat_time = 5
#stack_stat_shm = ICSCF_SIP_STAT
msg_log_file = $UASYS_HOME/log/ibcf/ibcfsipmsg
#msg_log_level = 0xFFFFFF
msg_log_format = 0x040080 # (UX_LOG_FMT_FILE_DAYOFMONTH | UX_LOG_FMT_THREAD_SAFE) 
#msg_log_file_size = 1000000000 #1G
#msg_log_file_count = 100

###################################################################################
# Service Selectors Configuration
###################################################################################

[UXCUTOR/SERVICE_SELECTOR/MASIP/COMMON]
# SMPP Service Selector common configuration : lib=libuxcss_smpp, class=uxcss_smpp_t
#PA_NAME=PA_SMPP # PA Name(default PA_SMPP)

[UXCUTOR/SERVICE_SELECTOR/MASIP/META]
# message field name; data type; map kind
msg.method; enum(INVITE=1,ACK,CANCEL,BYE,OPTIONS,REGISTER,INFO,PRACK,UPDATE,MESSAGE,SUBSCRIBE,NOTIFY,REFER,PUBLISH); HASH(,30);
Route.uri.user; str; PREFIX;
$fromtime; time; RBTREE

[UXCUTOR/SERVICE_SELECTOR/MASIP/RULE]
#serivce-name; key(msg.method); key(service); key(fromtime);
register; REGISTER; ; ;
invite; INVITE; ; ;
subscribe; SUBSCRIBE; ; ;
request; MESSAGE; ; ;
request; REFER; ; ;
request; PUBLISH; ; ;
request; INFO; ; ;

[UXCUTOR/SERVICE_SELECTOR/MADIA/META]
# message field name; data type; map kind
hdr.app_id; int; HASH;
hdr.code; int; HASH;
Service-Context-Id; str; HASH;

[UXCUTOR/SERVICE_SELECTOR/MADIA/RULE]
#serivce-name; key(hdr.app_id); key(hdr.code); key(Service-Context-Id);
#hss_lir; 16777216; 302;

###################################################################################
# Plugin Configuration
###################################################################################
[UXCUTOR/IBCF/COMMON]
DEFAULT_PRIVACY = none
USE_THIG = no 
THIG_HOST = uangel.com
THIG_KEY = a1b2c3d4e5f6g789
#THIG_AES = CBC;256
THIG_INDOMAIN = uangel.com;192.168.1.182;
RTPP_LOG = rtpp_log

[UXCUTOR/PLUGIN/UIMS/COMMON]
#sess_db 			= TNTDB

[UXCUTOR/PLUGIN/UIMS/DB]
#ID; NAME ; DLL;            ; FUNC; CONFSTR 
  0; MYSQL;                 ; uims_udbcdb_get_module; libudbc_mysql.so; user=root; password=root.123; host=192.168.1.122; dbname=ibcf
  1; TNTDB; libuims_tntdb.so; uims_tntdb_get_module; admin:admin@localhost:13404; ; reconnect_period=2; error_wait_msec=500 

[UXCUTOR/PLUGIN/IBCF/RTPP]
#ID; NAME      	DLL                   	FUNC                	CONFIG   
 0; RTPPROXY; 	libibcf_rtppxy.so; 	ibcf_rtppxy_get_module; distribution = rr; timeout = 3000 # confstr, if needed
 1; RTPENGINE; libibcf_rtpng.so;   ibcf_rtpng_get_module; # confstr, if needed

[UXCUTOR/PLUGIN/IBCF/RTPP/RTPPROXY]
#ID; IP           ; PORT   CONFIG
   1; 127.0.0.1;	12221;
#   1; 127.0.0.1;		37223;
#  2; 192.168.1.182;	12301;
#  3; 192.168.1.182;	12401;

[UXCUTOR/PLUGIN/IBCF/RTPP/RTPENGINE]
#ID; KIND; IP                       ; PORT  ; CONFIG
  1;  UDP;                 127.0.0.1;  12321;
# 2; UNIX;             ???;
# 3; UDP6; fe80::76d4:35ff:feee:8a76;  12301;


[UXCUTOR/PA_DIAMETER/CHANNEL]
#
#
[UXCUTOR/SERVICE_SELECTOR/MADIA/META]
# message field name; data type; map kind
hdr.app_id; int; HASH;
hdr.code; int; HASH;
Service-Context-Id; str; HASH;

[UXCUTOR/SERVICE_SELECTOR/MADIA/RULE]


[UXCUTOR/XCRIPT/DIA]
REPLACE_GET_THRID   = 1 # thread id 획득 함수를 교체할지 여부, default=true
USE_MSG_APP_ID = 0 # message application id를 사용할지 여부 default=false
PA_NAME = PA_DIAMETER # XCRIPT 참조할 DIAMETER Portocol Adapter의 이름. default='PA_DIAMETER'
INDEX_NAME = DIAMETER # XCRIPT service에서 DIAMETER 세션 검색을 위해 사용할 index 이름.                  default='DIAMETER'
USE_LOCAL_SESSION = 1 # local session을 사용할지 여부 default=true
LOCAL_SESS_HOST = # Local session 구분 host 이름. default=''
LOCAL_SESS_KEY = # Local session 구분 key 값. default=''
